# UFC-predictor
---

### Основные сведения
Данный проект является попыткой получения предсказаний результатов поединков по смешанных единоборствам (ММА) в крупнейшем ММА промоушене [UFC](https://www.ufc.com) при помощи различных ML и DL моделей. 
Предсказание победтиеля (условно: боец в красном, или боец в синем) делается на основании: 
 - физических данных бойцов;
 - статистических показателей по результатам предыдущих поединков (среднего количества выбрасываемых в минуту ударов и т.д.);
 - коэффициентов букмекеров на победу каждого из бойцов.

Помимо предсказания победителя, определяются вероятности победы каждого из бойцов в предстоящем поединке.

### Используемые данные
Для обучения моделей использовался [датасет](https://www.kaggle.com/datasets/mdabbert/ultimate-ufc-dataset) с платформы [kaggle.com](https://www.kaggle.com), содержащий данные о 6528 боях, проведенных в UFC за период 2010-2024 гг.

Данные были предобработаны и очищены от аномалий, пропуски в данных заполнены. Кроме того была сделана аугментация данных и созданы новые признаки. Процесс и результаты разведочного анализа и обработки данных приведены в ноутбуке [EDA.ipynb](https://github.com/IlyaPhil/UFC-predictor/blob/main/EDA.ipynb).

### Используемые метрики качества
Для оценки качества предсказаний была введена следующая метрика $p$ (performance), определяемая как:

 $$p=\frac{\sum_{i=1}^{n}{g_{i}^{pred}}-\sum_{i=1}^{n}{g_{i}^{odds}}}{\sum_{i=1}^{n}{g_{i}^{odds}}}\cdot100$$, где
 
 $$\sum_{i=1}^{n}{g_{i}^{pred}}$$ - сумма выигрыша при ставках на победителя, предсказанного моделью, для n боев, руб.,
 
 $$\sum_{i=1}^{n}{g_{i}^{odds}}$$ - сумма выигрыша при ставках на фаворита, определяемого коэффициентами букмекеров, для n боев, руб.

Значение метрики p показывает насколько больше денег (в %) можно выиграть, если ставить, как предсказывает модель, а не так, как "подсказывают" коэффициенты букмекеров.
Помимо данной метрики оценивались и стандартная метрика f1_score, скорее, для информации.

### Разработанные модели и результаты

На данный момент реализованы следующие модели
|Модель                           | p   |f1_score |
| --------------------------------|-----|---------|
|Логистическая регрессия          |3.8% |0.70     |
|XGBoost + isotonic_regression    |12.3%|0.72     |
|RNN|                             5.2%  |0.70     |

Более подробнаяя информация о разработке представленных, а также других, не вошедших в финальный перечень моделей представлена в ноутбуке [models.ipynb](https://github.com/IlyaPhil/UFC-predictor/blob/main/models.ipynb) 

### Веб-сервис для взаимодействия с моделями

В данный момент ведется разработка веб-сервиса. Пока реализован базовый функционал прототипов серверной части на fastapi 0.115.6 и клиентской на streamlit 1.41.1. Код прототипов представлен в папках [backend](https://github.com/IlyaPhil/UFC-predictor/tree/main/backend) и [frontend](https://github.com/IlyaPhil/UFC-predictor/tree/main/frontend) соответственно

